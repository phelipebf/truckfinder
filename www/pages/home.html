<div id="internal-page">

    <script type="text/javascript">
        
        var map;
        var myLocation = null;        
        
        document.addEventListener("deviceready", function () {
            
            // Define tamanho do mapa pra tela toda - altura do top header
            $("#map_canvas").height(window.innerHeight - FG.$headerApp.height());
            
            var div = document.getElementById("map_canvas");
                        
            // Initialize the map view
            map = plugin.google.maps.Map.getMap(div, {
                'controls': {
                    'compass': true,
                    'myLocationButton': true,
                    'indoorPicker': true,
                    'zoom': true
                }
            });
                        
            // Wait until the map is ready status.
            map.addEventListener(plugin.google.maps.event.MAP_READY, onMapReady);
        }, false);
                
        function onMapReady() {
            
            // Seta o foco do mapa no local atual do usuário/GPS
            map.getMyLocation(onSuccessGettingLocation, onErrorGettingLocation);
            
            // Markers
            // TODO: Implementar serviço REST para markers
            var trucks = [
                {"latlng":[-15.879222, -48.012081], name:"Burguer Truck", snip:"Hoje, 14:00 - 20:00"},
                {"latlng":[-15.878773, -48.014715], name:"Chili na Rua", snip:"Hoje, 14:00 - 20:00"},
                {"latlng":[-15.881348, -48.014130], name:"Sushi Truck", snip:"Hoje, 14:00 - 20:00"},
                {"latlng":[-15.883304, -48.012301], name:"Sucopira", snip:"Hoje, 14:00 - 20:00"},
            ];
              
            // Itera a lista de markers e adiciona os markers no mapa
            var bounds = trucks.map(function(info) {
                var latLng = new plugin.google.maps.LatLng(info.latlng[0], info.latlng[1]);
                                
                map.addMarker({
                    "position": latLng,
                    "title": info.name,
                    "snippet": info.snip,
                    icon: "orange"
                }, function(marker) {
                        marker.showInfoWindow();

                        // Ao clicar no info window (balão informativo) acima
                        // do marker, abre sistema de navegação do aparelho
                        marker.addEventListener(plugin.google.maps.event.INFO_CLICK, function() {
                            plugin.google.maps.external.launchNavigation({
                                "from": myLocation,
                                "to": latLng
                            });
                        });
                    }
                );                
                
                return latLng;
            });
              
            map.moveCamera({
                "target": bounds
            });
        }

        function onSuccessGettingLocation(location) 
        {
          myLocation = location.latLng;
      
          map.animateCamera({                
                'target': {
                    lat: location.latLng.lat,
                    lng: location.latLng.lng
                },
                'tilt': 60,
                'zoom': 18,
                'bearing': 140
            });
        }

        function onErrorGettingLocation(location) 
        {
            var msg = ["Localidade:\n",
                        "latitude:" + location.latLng.lat,
                        "longitude:" + location.latLng.lng,
                        "speed:" + location.speed,
                        "time:" + location.time,
                        "bearing:" + location.bearing].join("\n").toString();            
            
            alert("Erro: Impossível determinar localização\n" + msg);
        }      
    
    /* function onBtnClicked() {
        map.showDialog();
    } */
    </script>

    <div style="width:100%;height:450px" id="map_canvas"></div>

    <!-- <div class='page-item'>
            <p>FastGap é um template feito por brasileiros para iniciar o desenvolvimento de apps nativos para smartphones utilizando o PhoneGap.</p>
    </div>
    <div class='page-item'>
            <p>FastGap is a template created by Brazilians to start developing native apps for smartphones using PhoneGap.
                    <br/>
                    <br/>open menu for features
                    <br/>
                    <a href="https://github.com/GustavoCostaW/FastGap" target="_blank">https://github.com/FastGap/FastGap</a>
            </p>
    </div>
    <div class='page-item'>
            <p>Made with Love and with Zepto, SnapJS, FastClick, Overthrow.</p>
    </div>
    <div class='developers'>
            <h1>Developers</h1>
            <div>
                    <img data-git="http://github.com/GustavoCostaW" src='https://avatars2.githubusercontent.com/u/874909?s=60' alt='Gustavo Costa' />
                    <h6>@GustavoCostaW</h6>
            </div>
            <div>
                    <img data-git="http://github.com/pragmaticivan" src='https://avatars2.githubusercontent.com/u/301291?s=60' alt='Ivan Santos' />
                    <h6>@pragmaticivan</h6>
            </div>
            <div>
                    <img data-git="http://github.com/mayroncachina" src='https://avatars3.githubusercontent.com/u/52841?s=60' alt='Mayron Cachina' />
                    <h6>@mayroncachina</h6>
            </div>
            <div>
                    <img data-git="http://github.com/danielfeelfine" src='https://avatars3.githubusercontent.com/u/1668289?s=60' alt='Daniel Feel Fine' />
                    <h6>@danielfeelfine</h6>
            </div>
    </div> -->


</div>
